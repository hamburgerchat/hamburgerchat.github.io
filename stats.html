<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Hamburger ‚Äî –ò—Ç–æ–≥–∏ 2025</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/gsap@3.12.0/dist/gsap.min.js"></script>
    <style>
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --border-color: #334155;
            --accent-color: #ff7f50;
            --accent-gradient: linear-gradient(135deg, #ff7f50, #ffcc70);
            --card-bg: #1e293b;
            --hover-bg: #334155;
            --danger-color: #ef4444;
            --success-color: #10b981;
            --bot-color: #34d399;
            --info-color: #3b82f6;
            --warning-color: #f59e0b;
            --purple-color: #8b5cf6;
            --pink-color: #ec4899;
        }

        * { 
            box-sizing: border-box; 
            margin: 0; 
            padding: 0; 
            font-family: 'Inter', sans-serif; 
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        
        body {
            margin: 0;
            padding: 0;
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        .slides-wrapper {
            width: 100%;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        
        .slides-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            position: absolute;
            top: 0;
            left: 0;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .slide {
            width: 100vw;
            height: 100vh;
            flex-shrink: 0;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .slide-content {
            max-width: 1200px;
            width: 100%;
            height: auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            z-index: 2;
            padding: 20px 0;
            margin: 0 auto;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-dots {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 1000;
        }
        
        .nav-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }
        
        .nav-dot.active {
            background: var(--accent-color);
            transform: scale(1.4);
            box-shadow: 0 0 20px rgba(255, 127, 80, 0.5);
        }
        
        .nav-dot:hover {
            background: var(--text-secondary);
            transform: scale(1.2);
        }
        
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–ª–∞–π–¥–∞ */
        .slide-title {
            font-size: clamp(2.5rem, 5vw, 3.5rem);
            font-weight: 800;
            margin-bottom: 1.5rem;
            line-height: 1.1;
            text-align: center;
        }
        
        .slide-subtitle {
            font-size: clamp(1.1rem, 3vw, 1.3rem);
            color: var(--text-secondary);
            margin-bottom: 3rem;
            max-width: 800px;
            line-height: 1.6;
            text-align: center;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* –°–ª–∞–π–¥ 1: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ */
        #slide1 {
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
        }
        
        .burger-icon {
            position: absolute;
            font-size: clamp(10rem, 25vw, 20rem);
            color: var(--accent-color);
            opacity: 0.1;
            z-index: 1;
            pointer-events: none;
            animation: pulse 4s ease-in-out infinite;
        }
        
        .burger-1 {
            top: 10%;
            right: 10%;
        }
        
        .burger-2 {
            bottom: 10%;
            left: 10%;
            animation-delay: 2s;
        }
        
        @keyframes pulse {
            0%, 100% { 
                transform: scale(1) rotate(0deg);
                opacity: 0.1;
            }
            50% { 
                transform: scale(1.1) rotate(10deg);
                opacity: 0.2;
            }
        }
        
        .start-btn {
            padding: 18px 36px;
            background: var(--accent-gradient);
            color: white;
            border: none;
            border-radius: 16px;
            font-weight: 600;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 2rem auto 0;
            box-shadow: 0 8px 25px rgba(255, 127, 80, 0.3);
            width: fit-content;
        }
        
        .start-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(255, 127, 80, 0.4);
        }
        
        .start-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        /* –°–ª–∞–π–¥ 2: –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        #slide2 {
            background: linear-gradient(135deg, #1e293b 0%, #312e81 100%);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-top: 2rem;
            width: 100%;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 28px;
            transition: all 0.4s ease;
            min-height: 240px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent-gradient);
        }
        
        .stat-card:hover {
            transform: translateY(-10px);
            border-color: rgba(255, 127, 80, 0.3);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }
        
        .stat-icon {
            width: 64px;
            height: 64px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            color: white;
            margin-bottom: 1.5rem;
            background: var(--accent-gradient);
        }
        
        .stat-value {
            font-size: clamp(2.5rem, 5vw, 3.2rem);
            font-weight: 800;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #ff7f50, #ffcc70);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }
        
        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }
        
        /* –°–ª–∞–π–¥ 3: –ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ */
        #slide3 {
            background: linear-gradient(135deg, #1e293b 0%, #1e3a8a 100%);
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 28px;
            margin-top: 2rem;
            height: 450px;
            width: 100%;
            position: relative;
        }
        
        /* –°–ª–∞–π–¥ 4: –¢–æ–ø —á–∞—Ç–æ–≤ */
        #slide4 {
            background: linear-gradient(135deg, #1e293b 0%, #4c1d95 100%);
        }
        
        .top-chats-container {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 2rem;
            max-width: 900px;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
        }
        
        .top-chat-item {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 24px;
            display: flex;
            align-items: center;
            gap: 24px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .top-chat-item:hover {
            transform: translateX(10px);
            border-color: rgba(255, 127, 80, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .chat-rank {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.4rem;
            color: white;
            flex-shrink: 0;
        }
        
        .rank-1 { 
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
            box-shadow: 0 0 30px rgba(245, 158, 11, 0.3);
        }
        .rank-2 { 
            background: linear-gradient(135deg, #94a3b8, #cbd5e1);
            box-shadow: 0 0 20px rgba(148, 163, 184, 0.3);
        }
        .rank-3 { 
            background: linear-gradient(135deg, #92400e, #b45309);
            box-shadow: 0 0 20px rgba(146, 64, 14, 0.3);
        }
        .rank-other { 
            background: linear-gradient(135deg, var(--purple-color), #a78bfa);
        }
        
        .chat-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--accent-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: white;
            flex-shrink: 0;
            background-size: cover;
            background-position: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .chat-info {
            flex: 1;
            min-width: 0;
        }
        
        .chat-name {
            font-weight: 600;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .chat-stats {
            display: flex;
            gap: 24px;
            font-size: 0.95rem;
            color: var(--text-secondary);
            flex-wrap: wrap;
        }
        
        /* –°–ª–∞–π–¥ 5: –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è */
        #slide5 {
            background: linear-gradient(135deg, #1e293b 0%, #0c4a6e 100%);
        }
        
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-top: 2rem;
            width: 100%;
        }
        
        .achievement-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 28px;
            transition: all 0.4s ease;
            min-height: 260px;
            position: relative;
            overflow: hidden;
        }
        
        .achievement-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent-gradient);
        }
        
        .achievement-card:hover {
            transform: translateY(-8px);
            border-color: rgba(255, 127, 80, 0.3);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }
        
        .achievement-icon {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            margin-bottom: 1.5rem;
            background: var(--accent-gradient);
            box-shadow: 0 8px 25px rgba(255, 127, 80, 0.2);
        }
        
        .achievement-name {
            font-weight: 700;
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
        }
        
        .achievement-desc {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.5;
            min-height: 3rem;
        }
        
        .progress-container {
            margin-top: 1rem;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--accent-gradient);
            border-radius: 4px;
            transition: width 1.5s ease-out;
            width: 0%;
        }
        
        /* –°–ª–∞–π–¥ 6: –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–ª–∞–π–¥ */
        #slide6 {
            background: linear-gradient(135deg, #1e293b 0%, #064e3b 100%);
            text-align: center;
        }
        
        .final-stats {
            display: flex;
            justify-content: center;
            gap: 48px;
            flex-wrap: wrap;
            margin: 3rem 0;
            width: 100%;
        }
        
        .final-stat {
            text-align: center;
            min-width: 160px;
        }
        
        .final-value {
            font-size: clamp(3rem, 7vw, 4.5rem);
            font-weight: 800;
            background: linear-gradient(135deg, #ff7f50, #ffcc70);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
            margin-bottom: 0.8rem;
        }
        
        .final-label {
            font-size: 1.1rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 500;
        }
        
        .share-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 3rem;
            flex-wrap: wrap;
            width: 100%;
        }
        
        .share-btn {
            padding: 18px 36px;
            border-radius: 16px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.1rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        .share-btn.telegram {
            background: linear-gradient(135deg, #0088cc, #24a1e1);
            color: white;
        }
        
        .share-btn.whatsapp {
            background: linear-gradient(135deg, #25D366, #5af78a);
            color: white;
        }
        
        .share-btn.restart {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .share-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }
        
        /* –ó–∞–≥—Ä—É–∑–∫–∞ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            transition: opacity 0.5s ease;
        }
        
        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 2rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ */
        .scroll-hint {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--text-secondary);
            font-size: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            animation: bounce 2s infinite;
            pointer-events: none;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-15px); }
        }
        
        /* –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 1001;
        }
        
        .progress-bar-fill {
            height: 100%;
            background: var(--accent-gradient);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏ */
        .nav-arrows {
            position: fixed;
            bottom: 40px;
            right: 40px;
            display: flex;
            gap: 20px;
            z-index: 1000;
        }
        
        .nav-arrow {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .nav-arrow:hover {
            background: var(--accent-color);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(255, 127, 80, 0.3);
        }
        
        .nav-arrow:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            transform: none !important;
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è */
        .animate-in {
            opacity: 0;
            transform: translateY(40px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }
        
        .animate-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .animate-left {
            opacity: 0;
            transform: translateX(-40px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }
        
        .animate-left.visible {
            opacity: 1;
            transform: translateX(0);
        }
        
        .animate-right {
            opacity: 0;
            transform: translateX(40px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }
        
        .animate-right.visible {
            opacity: 1;
            transform: translateX(0);
        }
        
        .animate-scale {
            opacity: 0;
            transform: scale(0.8);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }
        
        .animate-scale.visible {
            opacity: 1;
            transform: scale(1);
        }
        
        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ */
        @media (max-width: 768px) {
            .slide {
                padding: 16px;
                justify-content: flex-start;
                padding-top: 100px;
            }
            
            .slide-content {
                padding-top: 20px;
                overflow-y: auto;
                padding-bottom: 120px;
            }
            
            .nav-dots {
                right: 16px;
                gap: 12px;
            }
            
            .nav-dot {
                width: 10px;
                height: 10px;
            }
            
            .nav-arrows {
                bottom: 20px;
                right: 20px;
                gap: 12px;
            }
            
            .nav-arrow {
                width: 48px;
                height: 48px;
                font-size: 1rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .stat-card {
                padding: 24px;
                min-height: 200px;
            }
            
            .stat-icon {
                width: 56px;
                height: 56px;
                font-size: 1.4rem;
                margin-bottom: 1rem;
            }
            
            .stat-value {
                font-size: 2.5rem;
            }
            
            .chart-container {
                height: 350px;
                padding: 20px;
                margin-top: 1rem;
            }
            
            .top-chat-item {
                padding: 20px;
                gap: 20px;
            }
            
            .chat-rank {
                width: 48px;
                height: 48px;
                font-size: 1.2rem;
            }
            
            .chat-avatar {
                width: 48px;
                height: 48px;
            }
            
            .chat-stats {
                gap: 16px;
                font-size: 0.9rem;
            }
            
            .achievements-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .achievement-card {
                padding: 24px;
                min-height: 220px;
            }
            
            .achievement-icon {
                width: 64px;
                height: 64px;
                font-size: 1.6rem;
            }
            
            .achievement-desc {
                min-height: auto;
            }
            
            .final-stats {
                gap: 32px;
            }
            
            .final-value {
                font-size: 3rem;
            }
            
            .share-buttons {
                flex-direction: column;
                align-items: center;
                gap: 16px;
            }
            
            .share-btn {
                width: 100%;
                max-width: 320px;
                justify-content: center;
                padding: 16px 24px;
            }
            
            .burger-icon {
                font-size: 12rem;
            }
            
            .scroll-hint {
                bottom: 100px;
                font-size: 0.9rem;
            }
            
            .start-btn {
                width: 100%;
                justify-content: center;
                padding: 16px 24px;
            }
            
            .progress-container {
                height: 3px;
            }
        }
        
        @media (max-width: 480px) {
            .slide-title {
                font-size: 2.2rem;
                margin-bottom: 1rem;
            }
            
            .slide-subtitle {
                font-size: 1.1rem;
                margin-bottom: 2rem;
            }
            
            .stat-value {
                font-size: 2.2rem;
            }
            
            .chart-container {
                height: 300px;
                padding: 16px;
            }
            
            .chat-stats {
                flex-direction: column;
                gap: 8px;
            }
            
            .final-value {
                font-size: 2.5rem;
            }
            
            .burger-icon {
                font-size: 10rem;
            }
            
            .nav-dots {
                right: 12px;
                gap: 10px;
            }
            
            .nav-arrows {
                bottom: 16px;
                right: 16px;
            }
            
            .nav-arrow {
                width: 44px;
                height: 44px;
            }
        }
        
        @media (max-height: 700px) and (orientation: portrait) {
            .slide-content {
                justify-content: flex-start;
                padding-top: 80px;
            }
            
            .stat-card {
                min-height: 180px;
                padding: 20px;
            }
            
            .stat-icon {
                width: 48px;
                height: 48px;
                font-size: 1.2rem;
                margin-bottom: 0.8rem;
            }
            
            .stat-value {
                font-size: 2rem;
            }
            
            .chart-container {
                height: 280px;
            }
            
            .achievement-card {
                min-height: 200px;
                padding: 20px;
            }
            
            .achievement-icon {
                width: 56px;
                height: 56px;
                font-size: 1.4rem;
                margin-bottom: 1rem;
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ —á–∏—Å–µ–ª */
        .number-count {
            display: inline-block;
        }
    </style>
</head>
<body>
    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä -->
    <div class="progress-container">
        <div class="progress-bar-fill" id="progressBar"></div>
    </div>
    
    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div style="font-size: 1.2rem; margin-bottom: 0.5rem;">–ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞—à—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É 2025...</div>
        <div style="color: var(--text-tertiary); font-size: 0.9rem;">–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥</div>
    </div>
    
    <!-- –û–±–µ—Ä—Ç–∫–∞ —Å–ª–∞–π–¥–æ–≤ -->
    <div class="slides-wrapper">
        <div class="slides-container" id="slidesContainer">
            <!-- –°–ª–∞–π–¥ 1: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
            <section class="slide" id="slide1">
                <div class="burger-icon burger-1">üçî</div>
                <div class="burger-icon burger-2">üçî</div>
                
                <div class="slide-content">
                    <h1 class="slide-title animate-in">–í–∞—à 2025 –≥–æ–¥ –≤ <span style="color: #ff7f50">Hamburger</span></h1>
                    <p class="slide-subtitle animate-in" style="transition-delay: 0.2s">
                        –û—Ç–∫—Ä–æ–π—Ç–µ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∞—à–µ–≥–æ –æ–±—â–µ–Ω–∏—è –∑–∞ –≥–æ–¥. 
                        –£–∑–Ω–∞–π—Ç–µ, —Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏, –∫–∞–∫–∏–µ —á–∞—Ç—ã –±—ã–ª–∏ —Å–∞–º—ã–º–∏ –∞–∫—Ç–∏–≤–Ω—ã–º–∏ 
                        –∏ –∫–∞–∫–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∏–ª–∏.
                    </p>
                    <button class="start-btn animate-in" id="startBtn" style="transition-delay: 0.4s">
                        <i class="fas fa-rocket"></i>
                        –ü–æ–∫–∞–∑–∞—Ç—å –º–æ—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    </button>
                </div>
                
                <div class="scroll-hint animate-in" style="transition-delay: 0.6s">
                    <span>–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
            </section>
            
            <!-- –°–ª–∞–π–¥ 2: –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <section class="slide" id="slide2">
                <div class="slide-content">
                    <h2 class="slide-title animate-in">–¶–∏—Ñ—Ä—ã –≥–æ–≤–æ—Ä—è—Ç —Å–∞–º–∏ –∑–∞ —Å–µ–±—è</h2>
                    <p class="slide-subtitle animate-in" style="transition-delay: 0.2s">–í–∞—à–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —Ü–∏—Ñ—Ä–∞—Ö –∑–∞ 2025 –≥–æ–¥</p>
                    
                    <div class="stats-grid">
                        <div class="stat-card animate-in" style="transition-delay: 0.3s">
                            <div class="stat-icon">
                                <i class="fas fa-comment"></i>
                            </div>
                            <div class="stat-value" id="totalMessages">0</div>
                            <div class="stat-label">–°–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</div>
                        </div>
                        
                        <div class="stat-card animate-in" style="transition-delay: 0.4s">
                            <div class="stat-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-value" id="totalChats">0</div>
                            <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤</div>
                        </div>
                        
                        <div class="stat-card animate-in" style="transition-delay: 0.5s">
                            <div class="stat-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-value" id="totalHours">0 —á</div>
                            <div class="stat-label">–í—Ä–µ–º—è –≤ —Å–µ—Ç–∏</div>
                        </div>
                        
                        <div class="stat-card animate-in" style="transition-delay: 0.6s">
                            <div class="stat-icon">
                                <i class="fas fa-heart"></i>
                            </div>
                            <div class="stat-value" id="totalReactions">0</div>
                            <div class="stat-label">–†–µ–∞–∫—Ü–∏–π –ø–æ–ª—É—á–µ–Ω–æ</div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- –°–ª–∞–π–¥ 3: –ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
            <section class="slide" id="slide3">
                <div class="slide-content">
                    <h2 class="slide-title animate-in">–í–∞—à–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –º–µ—Å—è—Ü–∞–º</h2>
                    <p class="slide-subtitle animate-in" style="transition-delay: 0.2s">–ö–æ–≥–¥–∞ –≤—ã –±—ã–ª–∏ –Ω–∞–∏–±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω—ã –≤ 2025 –≥–æ–¥—É</p>
                    
                    <div class="chart-container animate-right" style="transition-delay: 0.3s">
                        <canvas id="monthlyChart"></canvas>
                    </div>
                </div>
            </section>
            
            <!-- –°–ª–∞–π–¥ 4: –¢–æ–ø —á–∞—Ç–æ–≤ -->
            <section class="slide" id="slide4">
                <div class="slide-content">
                    <h2 class="slide-title animate-in">–¢–æ–ø-5 —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤</h2>
                    <p class="slide-subtitle animate-in" style="transition-delay: 0.2s">–ß–∞—Ç—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã –æ–±—â–∞–ª–∏—Å—å –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ</p>
                    
                    <div class="top-chats-container" id="topChatsContainer">
                        <!-- –ß–∞—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
            </section>
            
            <!-- –°–ª–∞–π–¥ 5: –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
            <section class="slide" id="slide5">
                <div class="slide-content">
                    <h2 class="slide-title animate-in">–í–∞—à–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
                    <p class="slide-subtitle animate-in" style="transition-delay: 0.2s">–ù–∞–≥—Ä–∞–¥—ã –∑–∞ –≤–∞—à—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ 2025 –≥–æ–¥—É</p>
                    
                    <div class="achievements-grid" id="achievementsGrid">
                        <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
            </section>
            
            <!-- –°–ª–∞–π–¥ 6: –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–ª–∞–π–¥ -->
            <section class="slide" id="slide6">
                <div class="slide-content">
                    <h2 class="slide-title animate-in">–û—Ç–ª–∏—á–Ω—ã–π –≥–æ–¥!</h2>
                    <p class="slide-subtitle animate-in" style="transition-delay: 0.2s">–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç–µ Hamburger –ª—É—á—à–µ —Å –∫–∞–∂–¥—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º</p>
                    
                    <div class="final-stats">
                        <div class="final-stat animate-in" style="transition-delay: 0.3s">
                            <div class="final-value" id="finalMessages">0</div>
                            <div class="final-label">–°–æ–æ–±—â–µ–Ω–∏–π</div>
                        </div>
                        <div class="final-stat animate-in" style="transition-delay: 0.4s">
                            <div class="final-value" id="finalChats">0</div>
                            <div class="final-label">–ß–∞—Ç–æ–≤</div>
                        </div>
                        <div class="final-stat animate-in" style="transition-delay: 0.5s">
                            <div class="final-value" id="finalDays">0</div>
                            <div class="final-label">–î–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</div>
                        </div>
                    </div>
                    
                    <div class="share-buttons">
                        <button class="share-btn telegram animate-in" id="shareTelegram" style="transition-delay: 0.6s">
                            <i class="fab fa-telegram"></i>
                            –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ Telegram
                        </button>
                        <button class="share-btn whatsapp animate-in" id="shareWhatsApp" style="transition-delay: 0.7s">
                            <i class="fab fa-whatsapp"></i>
                            –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ WhatsApp
                        </button>
                        <button class="share-btn restart animate-in" id="restartBtn" style="transition-delay: 0.8s">
                            <i class="fas fa-redo"></i>
                            –ù–∞—á–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </div>
    
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ -->
    <div class="nav-dots" id="navDots">
        <div class="nav-dot active" data-slide="1"></div>
        <div class="nav-dot" data-slide="2"></div>
        <div class="nav-dot" data-slide="3"></div>
        <div class="nav-dot" data-slide="4"></div>
        <div class="nav-dot" data-slide="5"></div>
        <div class="nav-dot" data-slide="6"></div>
    </div>
    
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏ -->
    <div class="nav-arrows">
        <button class="nav-arrow" id="prevSlide" disabled>
            <i class="fas fa-chevron-up"></i>
        </button>
        <button class="nav-arrow" id="nextSlide">
            <i class="fas fa-chevron-down"></i>
        </button>
    </div>
    
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        const firebaseConfig = {
            databaseURL: "https://hamburgerchat-e8f2a-default-rtdb.firebaseio.com/"
        };
        
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const database = firebase.database();
        
        const ENCRYPTION_KEY = "HamburgerSecureKey2024!";
        
        let currentUser = null;
        let currentUserId = null;
        let currentYear = 2025;
        let monthlyChart = null;
        let userStats = null;
        let currentSlide = 1;
        let totalSlides = 6;
        let isGenerating = false;
        let isAnimating = false;

        // –§—É–Ω–∫—Ü–∏–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
        function encryptData(data) {
            return CryptoJS.AES.encrypt(JSON.stringify(data), ENCRYPTION_KEY).toString();
        }
        
        function decryptData(encryptedData) {
            try {
                const bytes = CryptoJS.AES.decrypt(encryptedData, ENCRYPTION_KEY);
                const decrypted = bytes.toString(CryptoJS.enc.Utf8);
                return decrypted ? JSON.parse(decrypted) : null;
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:', e);
                return null;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', async () => {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            currentUser = localStorage.getItem('hamburger_user');
            currentUserId = localStorage.getItem('hamburger_user_id');
            
            if (!currentUser || !currentUserId) {
                window.location.href = 'https://hamburgerchat.github.io/';
                return;
            }
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            setupNavigation();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª–∞–π–¥–æ–≤
            setupSlides();
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–µ—Ä–≤–æ–≥–æ —Å–ª–∞–π–¥–∞
            setTimeout(() => {
                showAnimations(1);
            }, 500);
        });

        function setupEventListeners() {
            // –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ä—Ç–∞
            document.getElementById('startBtn').addEventListener('click', loadStatistics);
            
            // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
            document.getElementById('restartBtn').addEventListener('click', () => {
                goToSlide(1);
            });
            
            // –ö–Ω–æ–ø–∫–∏ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è
            document.getElementById('shareTelegram').addEventListener('click', shareToTelegram);
            document.getElementById('shareWhatsApp').addEventListener('click', shareToWhatsApp);
            
            // –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏
            document.getElementById('prevSlide').addEventListener('click', () => {
                if (currentSlide > 1) goToSlide(currentSlide - 1);
            });
            
            document.getElementById('nextSlide').addEventListener('click', () => {
                if (currentSlide < totalSlides) goToSlide(currentSlide + 1);
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
                    if (currentSlide > 1) goToSlide(currentSlide - 1);
                } else if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
                    if (currentSlide < totalSlides) goToSlide(currentSlide + 1);
                }
            });
        }

        function setupNavigation() {
            const dots = document.querySelectorAll('.nav-dot');
            
            dots.forEach(dot => {
                dot.addEventListener('click', function() {
                    const slideNum = parseInt(this.dataset.slide);
                    goToSlide(slideNum);
                });
            });
        }

        function setupSlides() {
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
            let startY = 0;
            let isDragging = false;
            
            document.addEventListener('touchstart', (e) => {
                startY = e.touches[0].clientY;
                isDragging = true;
            }, { passive: true });
            
            document.addEventListener('touchmove', (e) => {
                if (!isDragging || isAnimating) return;
                
                const currentY = e.touches[0].clientY;
                const diff = startY - currentY;
                
                // –ï—Å–ª–∏ —Å–≤–∞–π–ø –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–π
                if (Math.abs(diff) > 50) {
                    if (diff > 0 && currentSlide < totalSlides) {
                        // –°–≤–∞–π–ø –≤–≤–µ—Ä—Ö
                        goToSlide(currentSlide + 1);
                        isDragging = false;
                    } else if (diff < 0 && currentSlide > 1) {
                        // –°–≤–∞–π–ø –≤–Ω–∏–∑
                        goToSlide(currentSlide - 1);
                        isDragging = false;
                    }
                }
            }, { passive: false });
            
            document.addEventListener('touchend', () => {
                isDragging = false;
            }, { passive: true });
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–µ—Å–∏–∫–∞ –º—ã—à–∏
            document.addEventListener('wheel', (e) => {
                if (isAnimating) return;
                
                if (e.deltaY > 0 && currentSlide < totalSlides) {
                    goToSlide(currentSlide + 1);
                } else if (e.deltaY < 0 && currentSlide > 1) {
                    goToSlide(currentSlide - 1);
                }
            }, { passive: false });
        }

        function updateProgressBar() {
            const progress = ((currentSlide - 1) / (totalSlides - 1)) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        function updateNavigation() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ—á–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            const dots = document.querySelectorAll('.nav-dot');
            dots.forEach(dot => {
                const slideNum = parseInt(dot.dataset.slide);
                dot.classList.toggle('active', slideNum === currentSlide);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–µ–ª–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.getElementById('prevSlide').disabled = currentSlide === 1;
            document.getElementById('nextSlide').disabled = currentSlide === totalSlides;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
            updateProgressBar();
        }

        function goToSlide(slideNum) {
            if (isAnimating || slideNum < 1 || slideNum > totalSlides) return;
            
            isAnimating = true;
            currentSlide = slideNum;
            
            // –ü–µ—Ä–µ–º–µ—â–∞–µ–º —Å–ª–∞–π–¥—ã
            const slidesContainer = document.getElementById('slidesContainer');
            const offset = -(slideNum - 1) * 100;
            slidesContainer.style.transform = `translateY(${offset}vh)`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
            updateNavigation();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–ª–∞–π–¥–∞
            setTimeout(() => {
                showAnimations(slideNum);
                isAnimating = false;
            }, 300);
        }

        function showAnimations(slideNum) {
            const slide = document.getElementById(`slide${slideNum}`);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Å–ª–∞–π–¥–µ
            const animatedElements = slide.querySelectorAll('.animate-in, .animate-left, .animate-right, .animate-scale');
            animatedElements.forEach((element, index) => {
                setTimeout(() => {
                    element.classList.add('visible');
                }, index * 100);
            });
        }

        async function loadStatistics() {
            if (isGenerating) return;
            isGenerating = true;
            
            const startBtn = document.getElementById('startBtn');
            startBtn.disabled = true;
            startBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∂–∞–µ–º...';
            
            try {
                userStats = await collectRealStatistics();
                displayStatistics();
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                document.getElementById('loadingOverlay').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loadingOverlay').style.display = 'none';
                }, 500);
                
                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫–æ –≤—Ç–æ—Ä–æ–º—É —Å–ª–∞–π–¥—É
                setTimeout(() => {
                    goToSlide(2);
                }, 1000);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                alert('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
            } finally {
                isGenerating = false;
                startBtn.disabled = false;
                startBtn.innerHTML = '<i class="fas fa-rocket"></i> –ü–æ–∫–∞–∑–∞—Ç—å –º–æ—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É';
            }
        }

        async function collectRealStatistics() {
            const stats = {
                totalMessages: 0,
                totalChats: 0,
                totalHours: 0,
                totalReactions: 0,
                receivedReactions: 0,
                sentReactions: 0,
                activeDays: 0,
                monthlyData: Array(12).fill(0),
                topChats: [],
                achievements: []
            };
            
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —á–∞—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userChatsRef = database.ref(`userChats/${currentUserId}`);
            const userChatsSnapshot = await userChatsRef.once('value');
            
            if (!userChatsSnapshot.exists()) {
                return stats;
            }
            
            const userChats = userChatsSnapshot.val();
            const chatIds = Object.keys(userChats).filter(id => id !== 'L');
            
            stats.totalChats = chatIds.length;
            
            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–∂–¥–æ–º—É —á–∞—Ç—É
            const activeDaysSet = new Set();
            
            for (const chatId of chatIds) {
                try {
                    const chatStats = await analyzeChat(chatId, activeDaysSet);
                    
                    stats.totalMessages += chatStats.messages;
                    stats.totalReactions += chatStats.reactions;
                    stats.monthlyData = stats.monthlyData.map((val, idx) => val + chatStats.monthlyData[idx]);
                    
                    if (chatStats.messages > 0) {
                        stats.topChats.push({
                            id: chatId,
                            name: chatStats.name,
                            type: chatStats.type,
                            messageCount: chatStats.messages,
                            avatar: chatStats.avatar
                        });
                    }
                    
                } catch (error) {
                    console.error(`–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ —á–∞—Ç–∞ ${chatId}:`, error);
                }
            }
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
            stats.activeDays = activeDaysSet.size;
            stats.totalHours = Math.round(stats.totalMessages * 0.5 / 60); // 30 —Å–µ–∫—É–Ω–¥ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–æ–ø —á–∞—Ç–æ–≤
            stats.topChats.sort((a, b) => b.messageCount - a.messageCount);
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            determineAchievements(stats);
            
            return stats;
        }

        async function analyzeChat(chatId, activeDaysSet) {
            const result = {
                name: '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è',
                type: 'private',
                messages: 0,
                reactions: 0,
                monthlyData: Array(12).fill(0),
                avatar: null
            };
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —á–∞—Ç–∞
                const chatRef = database.ref(`chats/${chatId}`);
                const chatSnapshot = await chatRef.once('value');
                
                if (chatSnapshot.exists()) {
                    const chatData = chatSnapshot.val();
                    const decryptedData = decryptData(chatData.encryptedData);
                    
                    if (decryptedData) {
                        result.name = decryptedData.name || result.name;
                        result.type = decryptedData.type || result.type;
                        result.avatar = decryptedData.avatar;
                    }
                }
                
                // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞ 2025 –≥–æ–¥
                const messagesRef = database.ref(`messages/${chatId}`);
                const messagesSnapshot = await messagesRef.once('value');
                
                if (messagesSnapshot.exists()) {
                    const messages = messagesSnapshot.val();
                    
                    for (const messageId in messages) {
                        const messageData = messages[messageId];
                        const decryptedMessage = decryptData(messageData.encryptedData) || messageData;
                        
                        if (!decryptedMessage || !decryptedMessage.timestamp) continue;
                        
                        const messageDate = new Date(decryptedMessage.timestamp);
                        if (messageDate.getFullYear() !== 2025) continue;
                        
                        // –°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        if (decryptedMessage.sender === currentUserId) {
                            result.messages++;
                            
                            // –ú–µ—Å—è—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                            const month = messageDate.getMonth();
                            result.monthlyData[month]++;
                            
                            // –ê–∫—Ç–∏–≤–Ω—ã–µ –¥–Ω–∏
                            const dateStr = messageDate.toDateString();
                            activeDaysSet.add(dateStr);
                        }
                        
                        // –†–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        if (decryptedMessage.sender === currentUserId && decryptedMessage.reactions) {
                            for (const users of Object.values(decryptedMessage.reactions)) {
                                const userList = Array.isArray(users) ? users : [];
                                result.reactions += userList.length;
                            }
                        }
                    }
                }
                
            } catch (error) {
                console.error(`–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ —á–∞—Ç–∞ ${chatId}:`, error);
            }
            
            return result;
        }

        function determineAchievements(stats) {
            stats.achievements = [];
            
            // –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—è–º
            if (stats.totalMessages >= 1000) {
                stats.achievements.push({
                    name: '–ú–∞—Å—Ç–µ—Ä –æ–±—â–µ–Ω–∏—è',
                    description: '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–æ–ª–µ–µ 1000 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ 2025 –≥–æ–¥—É',
                    icon: 'fas fa-comments',
                    progress: 100,
                    unlocked: true
                });
            } else if (stats.totalMessages >= 500) {
                stats.achievements.push({
                    name: '–ê–∫—Ç–∏–≤–Ω—ã–π —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫',
                    description: '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–æ–ª–µ–µ 500 —Å–æ–æ–±—â–µ–Ω–∏–π',
                    icon: 'fas fa-comment',
                    progress: 100,
                    unlocked: true
                });
            } else {
                const progress = Math.min((stats.totalMessages / 500) * 100, 100);
                stats.achievements.push({
                    name: '–ù–∞—á–∏–Ω–∞—é—â–∏–π',
                    description: '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!',
                    icon: 'fas fa-comment',
                    progress: progress,
                    unlocked: progress >= 100
                });
            }
            
            // –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ —á–∞—Ç–∞–º
            if (stats.totalChats >= 10) {
                stats.achievements.push({
                    name: '–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –±–∞–±–æ—á–∫–∞',
                    description: '–ê–∫—Ç–∏–≤–µ–Ω –≤ 10+ —á–∞—Ç–∞—Ö',
                    icon: 'fas fa-users',
                    progress: 100,
                    unlocked: true
                });
            } else {
                const progress = Math.min((stats.totalChats / 10) * 100, 100);
                stats.achievements.push({
                    name: '–í—ã–±–∏—Ä–∞—é –æ–∫—Ä—É–∂–µ–Ω–∏–µ',
                    description: '–ê–∫—Ç–∏–≤–µ–Ω –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Ç–∞—Ö',
                    icon: 'fas fa-user-friends',
                    progress: progress,
                    unlocked: progress >= 100
                });
            }
            
            // –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ –¥–Ω—è–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
            if (stats.activeDays >= 300) {
                stats.achievements.push({
                    name: '–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
                    description: '–ê–∫—Ç–∏–≤–µ–Ω –±–æ–ª–µ–µ 300 –¥–Ω–µ–π –≤ –≥–æ–¥—É',
                    icon: 'fas fa-calendar-check',
                    progress: 100,
                    unlocked: true
                });
            } else if (stats.activeDays >= 150) {
                stats.achievements.push({
                    name: '–†–µ–≥—É–ª—è—Ä–Ω—ã–π –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—å',
                    description: '–ê–∫—Ç–∏–≤–µ–Ω –±–æ–ª–µ–µ 150 –¥–Ω–µ–π',
                    icon: 'fas fa-calendar',
                    progress: 100,
                    unlocked: true
                });
            } else {
                const progress = Math.min((stats.activeDays / 150) * 100, 100);
                stats.achievements.push({
                    name: '–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
                    description: '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∑–∞—Ö–æ–¥–∏—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å!',
                    icon: 'fas fa-calendar-day',
                    progress: progress,
                    unlocked: progress >= 100
                });
            }
            
            // –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ —Ä–µ–∞–∫—Ü–∏—è–º
            if (stats.totalReactions >= 100) {
                stats.achievements.push({
                    name: '–°–µ—Ä–¥—Ü–µ Hamburger',
                    description: '–ü–æ–ª—É—á–∏–ª –±–æ–ª–µ–µ 100 —Ä–µ–∞–∫—Ü–∏–π',
                    icon: 'fas fa-heart',
                    progress: 100,
                    unlocked: true
                });
            } else if (stats.totalReactions > 0) {
                const progress = Math.min((stats.totalReactions / 100) * 100, 100);
                stats.achievements.push({
                    name: '–ü–æ–ø—É–ª—è—Ä–Ω—ã–π —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫',
                    description: '–í–∞—à–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω—Ä–∞–≤—è—Ç—Å—è –¥—Ä—É–≥–∏–º',
                    icon: 'fas fa-heart',
                    progress: progress,
                    unlocked: progress >= 100
                });
            }
            
            // –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
            if (stats.totalMessages >= 500 && stats.activeDays >= 200) {
                stats.achievements.push({
                    name: '–õ–µ–≥–µ–Ω–¥–∞ Hamburger',
                    description: '–í—ã–¥–∞—é—â–∞—è—Å—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ –≥–æ–¥–∞',
                    icon: 'fas fa-crown',
                    progress: 100,
                    unlocked: true
                });
            }
        }

        function displayStatistics() {
            if (!userStats) return;
            
            // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
            animateNumber('totalMessages', userStats.totalMessages);
            animateNumber('totalChats', userStats.totalChats);
            animateNumber('totalHours', userStats.totalHours, true);
            animateNumber('totalReactions', userStats.totalReactions);
            
            // –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
            animateNumber('finalMessages', userStats.totalMessages);
            animateNumber('finalChats', userStats.totalChats);
            animateNumber('finalDays', userStats.activeDays);
            
            // –ì—Ä–∞—Ñ–∏–∫
            createMonthlyChart();
            
            // –¢–æ–ø —á–∞—Ç–æ–≤
            displayTopChats();
            
            // –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            displayAchievements();
        }

        function animateNumber(elementId, finalValue, isHours = false) {
            const element = document.getElementById(elementId);
            const suffix = isHours ? ' —á' : '';
            
            gsap.to(element, {
                textContent: finalValue,
                duration: 2,
                ease: "power2.out",
                snap: { textContent: 1 },
                onUpdate: function() {
                    const value = Math.floor(this.targets()[0].textContent);
                    element.textContent = value.toLocaleString() + suffix;
                }
            });
        }

        function createMonthlyChart() {
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            const monthNames = ['–Ø–Ω–≤', '–§–µ–≤', '–ú–∞—Ä', '–ê–ø—Ä', '–ú–∞–π', '–ò—é–Ω', '–ò—é–ª', '–ê–≤–≥', '–°–µ–Ω', '–û–∫—Ç', '–ù–æ—è', '–î–µ–∫'];
            
            if (monthlyChart) {
                monthlyChart.destroy();
            }
            
            monthlyChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: monthNames,
                    datasets: [{
                        label: '–°–æ–æ–±—â–µ–Ω–∏–π',
                        data: userStats.monthlyData,
                        backgroundColor: 'rgba(255, 127, 80, 0.1)',
                        borderColor: '#ff7f50',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#ff7f50',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#ff7f50',
                            borderWidth: 1,
                            cornerRadius: 8,
                            padding: 12
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#cbd5e1',
                                font: {
                                    size: 12
                                }
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#cbd5e1',
                                precision: 0,
                                font: {
                                    size: 12
                                }
                            }
                        }
                    }
                }
            });
        }

        function displayTopChats() {
            const container = document.getElementById('topChatsContainer');
            container.innerHTML = '';
            
            const topChats = userStats.topChats.slice(0, 5);
            
            if (topChats.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                        <i class="fas fa-comments" style="font-size: 3rem; margin-bottom: 1.5rem; opacity: 0.5;"></i>
                        <div style="font-size: 1.2rem; margin-bottom: 0.5rem;">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤ –∑–∞ 2025 –≥–æ–¥</div>
                        <div style="font-size: 0.9rem; opacity: 0.7;">–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–∞—Ç—å—Å—è, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É!</div>
                    </div>
                `;
                return;
            }
            
            topChats.forEach((chat, index) => {
                const rankClass = index === 0 ? 'rank-1' : index === 1 ? 'rank-2' : index === 2 ? 'rank-3' : 'rank-other';
                const delay = 0.3 + (index * 0.1);
                
                const chatElement = document.createElement('div');
                chatElement.className = 'top-chat-item animate-left';
                chatElement.style.transitionDelay = `${delay}s`;
                
                chatElement.innerHTML = `
                    <div class="chat-rank ${rankClass}">${index + 1}</div>
                    <div class="chat-avatar" style="${chat.avatar ? `background-image: url(${chat.avatar})` : ''}">
                        ${chat.avatar ? '' : chat.name.charAt(0).toUpperCase()}
                    </div>
                    <div class="chat-info">
                        <div class="chat-name">${chat.name}</div>
                        <div class="chat-stats">
                            <span><i class="fas fa-comment"></i> ${chat.messageCount} —Å–æ–æ–±—â–µ–Ω–∏–π</span>
                            <span>‚Ä¢</span>
                            <span><i class="fas fa-tag"></i> ${getChatTypeName(chat.type)}</span>
                        </div>
                    </div>
                `;
                
                chatElement.addEventListener('click', () => {
                    window.open(`https://hamburgerchat.github.io/chat.html?id=${chat.id}`, '_blank');
                });
                
                container.appendChild(chatElement);
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                container.querySelectorAll('.animate-left').forEach((el, i) => {
                    setTimeout(() => {
                        el.classList.add('visible');
                    }, i * 100);
                });
            }, 100);
        }

        function getChatTypeName(type) {
            const types = {
                'private': '–õ–∏—á–Ω—ã–π —á–∞—Ç',
                'group': '–ì—Ä—É–ø–ø–∞',
                'channel': '–ö–∞–Ω–∞–ª',
                'bot': '–ë–æ—Ç'
            };
            return types[type] || type;
        }

        function displayAchievements() {
            const container = document.getElementById('achievementsGrid');
            container.innerHTML = '';
            
            userStats.achievements.forEach((achievement, index) => {
                const delay = 0.3 + (index * 0.15);
                
                const achievementElement = document.createElement('div');
                achievementElement.className = 'achievement-card animate-scale';
                achievementElement.style.transitionDelay = `${delay}s`;
                
                achievementElement.innerHTML = `
                    <div class="achievement-icon">
                        <i class="${achievement.icon}"></i>
                    </div>
                    <div class="achievement-name">${achievement.name}</div>
                    <div class="achievement-desc">${achievement.description}</div>
                    <div class="progress-container">
                        <div class="progress-label">
                            <span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                            <span>${Math.round(achievement.progress)}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${achievement.progress}%"></div>
                        </div>
                    </div>
                    ${achievement.unlocked ? 
                        '<div style="margin-top: 1rem; color: #ffcc70; font-size: 0.9rem; display: flex; align-items: center; gap: 8px;"><i class="fas fa-check-circle"></i> –ü–æ–ª—É—á–µ–Ω–æ</div>' : 
                        '<div style="margin-top: 1rem; color: #94a3b8; font-size: 0.9rem; display: flex; align-items: center; gap: 8px;"><i class="fas fa-lock"></i> –í –ø—Ä–æ—Ü–µ—Å—Å–µ</div>'
                    }
                `;
                
                container.appendChild(achievementElement);
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ –∞–Ω–∏–º–∏—Ä—É–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã
            setTimeout(() => {
                container.querySelectorAll('.animate-scale').forEach((el, i) => {
                    setTimeout(() => {
                        el.classList.add('visible');
                        
                        // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
                        const progressFill = el.querySelector('.progress-fill');
                        const progressWidth = progressFill.style.width;
                        progressFill.style.width = '0%';
                        
                        setTimeout(() => {
                            progressFill.style.transition = 'width 1.5s ease-out';
                            progressFill.style.width = progressWidth;
                        }, 300);
                    }, i * 150);
                });
            }, 100);
        }

        function shareToTelegram() {
            const text = `üìä –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ Hamburger –∑–∞ 2025 –≥–æ–¥:
            
üí¨ –°–æ–æ–±—â–µ–Ω–∏–π: ${userStats.totalMessages.toLocaleString()}
üë• –ß–∞—Ç–æ–≤: ${userStats.totalChats}
‚è∞ –í —Å–µ—Ç–∏: ${userStats.totalHours} —á–∞—Å–æ–≤
‚ù§Ô∏è –†–µ–∞–∫—Ü–∏–π: ${userStats.totalReactions}
üìÖ –î–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: ${userStats.activeDays}

–û—Ç–∫—Ä–æ–π—Ç–µ —Å–≤–æ—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É!`;
            
            const url = `https://t.me/share/url?url=${encodeURIComponent(window.location.href)}&text=${encodeURIComponent(text)}`;
            window.open(url, '_blank');
        }

        function shareToWhatsApp() {
            const text = `üìä –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ Hamburger –∑–∞ 2025 –≥–æ–¥:
            
üí¨ –°–æ–æ–±—â–µ–Ω–∏–π: ${userStats.totalMessages.toLocaleString()}
üë• –ß–∞—Ç–æ–≤: ${userStats.totalChats}
‚è∞ –í —Å–µ—Ç–∏: ${userStats.totalHours} —á–∞—Å–æ–≤
‚ù§Ô∏è –†–µ–∞–∫—Ü–∏–π: ${userStats.totalReactions}
üìÖ –î–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: ${userStats.activeDays}

–û—Ç–∫—Ä–æ–π—Ç–µ —Å–≤–æ—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É!`;
            
            const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
            window.open(url, '_blank');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        setTimeout(() => {
            document.querySelectorAll('.animate-in').forEach((el, i) => {
                setTimeout(() => {
                    el.classList.add('visible');
                }, i * 100);
            });
        }, 500);
    </script>
</body>
</html>
